{"name": "API Test: Change VM Status", "status": "failed", "statusDetails": {"message": "AssertionError: Expected 204, got 422\nassert 422 == 204\n +  where 422 = <Response [422]>.status_code", "trace": "self = <test_vm_2_put_api.TestVMStatusManagement object at 0x7f7d969bda90>\n\n    @allure.title(\"API Test: Change VM Status\")\n    @allure.link(\"https://jira.cloud.ru/browse/TASK-PENDING\", name=\"Related Task\")\n    @allure.tag(\"NORMAL\")\n    @allure.label(\"priority\", \"normal\")\n    def test_scenario(self):\n        # Arrange\n        base_url = \"https://compute.api.cloud.ru\"\n    \n        # Configuration\n        vm_id = os.getenv(\"TEST_VM_ID\")\n        token = os.getenv(\"CLOUD_API_TOKEN\") # Security fix\n    \n        # Validation\n        assert vm_id, \"Please set TEST_VM_ID in your .env file\"\n    \n        vm_endpoint = f\"/api/v1/vms/{vm_id}\"\n        bulk_endpoint = \"/api/v1/vms\"\n    \n        headers = {\n            \"Authorization\": f\"Bearer {token}\",\n            \"Content-Type\": \"application/json\"\n        }\n    \n        # Step 1: Get Current State\n        with allure.step(f\"GET {vm_endpoint}\"):\n            response_get = requests.get(base_url + vm_endpoint, headers=headers)\n            assert response_get.status_code == 200, \"Failed to get current VM info\"\n            current_state = response_get.json()[\"state\"]\n    \n        # Step 2: Determine Target State\n        target_state = \"stopped\" if current_state == \"running\" else \"running\"\n    \n        # Step 3: PUT New State (Bulk Endpoint)\n        payload = [\n          {\n            \"id\": vm_id,\n            \"state\": target_state\n          }\n        ]\n    \n        # Act\n        with allure.step(f\"PUT {bulk_endpoint} -> Switch to {target_state}\"):\n            response = requests.put(base_url + bulk_endpoint, headers=headers, json=payload)\n    \n        # Assert\n        with allure.step(\"Check Status Code 204\"):\n>           assert response.status_code == 204, f\"Expected 204, got {response.status_code}\"\nE           AssertionError: Expected 204, got 422\nE           assert 422 == 204\nE            +  where 422 = <Response [422]>.status_code\n\n../../../../test/test_vm_2_put_api.py:57: AssertionError"}, "steps": [{"name": "GET /api/v1/vms/05a6dd90-d909-431d-accf-966a6104840a", "status": "passed", "start": 1765703473183, "stop": 1765703473795}, {"name": "PUT /api/v1/vms -> Switch to running", "status": "passed", "start": 1765703473795, "stop": 1765703474282}, {"name": "Check Status Code 204", "status": "failed", "statusDetails": {"message": "AssertionError: Expected 204, got 422\nassert 422 == 204\n +  where 422 = <Response [422]>.status_code\n", "trace": "  File \"/home/muhammad/Dev/HACKATHON/Moscow/cloud.ru/test/test_vm_2_put_api.py\", line 57, in test_scenario\n    assert response.status_code == 204, f\"Expected 204, got {response.status_code}\"\n"}, "start": 1765703474282, "stop": 1765703474283}], "start": 1765703473183, "stop": 1765703474285, "uuid": "cb6f4a61-2e3d-4c8b-bd27-6b6cc6e5cba8", "historyId": "05febb124c1dd2333179701989b9e188", "testCaseId": "05febb124c1dd2333179701989b9e188", "fullName": "test_vm_2_put_api.TestVMStatusManagement#test_scenario", "labels": [{"name": "suite", "value": "API"}, {"name": "tag", "value": "NORMAL"}, {"name": "story", "value": "Story: VMStatusManagement"}, {"name": "priority", "value": "normal"}, {"name": "feature", "value": "VMStatusManagement"}, {"name": "subSuite", "value": "TestVMStatusManagement"}, {"name": "host", "value": "222"}, {"name": "thread", "value": "304716-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "test_vm_2_put_api"}], "links": [{"type": "link", "url": "https://jira.cloud.ru/browse/TASK-PENDING", "name": "Related Task"}, {"type": "link", "url": "https://jira.cloud.ru/browse/TASK-API-VM-STATUS", "name": "API Docs"}], "titlePath": ["test_vm_2_put_api.py", "TestVMStatusManagement"]}